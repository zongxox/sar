<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.demo.mapper.PaymentRecordMapper">
    <resultMap id="PaymentRecordResultMap" type="com.example.demo.entity.PaymentRecord">
        <id column="id" property="id"/>
        <result column="receipt_no"  property="receiptNo"/>
        <result column="payer_name"  property="payerName"/>
        <result column="payee_name"  property="payeeName"/>
        <result column="amount"      property="amount"/>
        <result column="status"      property="status"/>
        <result column="pay_method"  property="payMethod"/>
        <result column="source"      property="source"/>
        <result column="create_time" property="createTime"/>
        <result column="update_time" property="updateTime"/>
    </resultMap>

    <resultMap id="init" type="com.example.demo.dao.PrInit0212DAO">
        <result column="status"      property="status"/>
        <result column="pay_method"  property="payMethod"/>
        <result column="source"      property="source"/>
    </resultMap>

<select id="init" resultMap="init">
    select status,pay_method,source from payment_record
</select>
<select id="query" resultMap="PaymentRecordResultMap">
    SELECT
        id, receipt_no, payer_name, payee_name,
        amount, status, pay_method, source,
        create_time, update_time
    FROM payment_record
    <where>
        <if test="receiptNo != null">
            AND receipt_no LIKE CONCAT('%',#{receiptNo},'%')
        </if>
        <if test="status != null and status != ''">
            AND status = #{status}
        </if>
        <if test="source != null and source != ''">
            AND source = #{source}
        </if>
        <if test="payMethod != null and payMethod.size() > 0">
            and pay_method in
            <foreach collection="payMethod" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
    </where>
</select>

<delete id="delete">
    delete from payment_record where id = #{id}
</delete>
</mapper>